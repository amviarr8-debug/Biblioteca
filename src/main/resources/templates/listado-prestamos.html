<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Listado de Pr√©stamos</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container mt-5">
  <h1 class="mb-4">üìã Listado de Pr√©stamos Activos e Hist√≥ricos</h1>
  <a th:href="@{/menu}" class="btn btn-secondary mb-3">‚Üê Volver al Men√∫ Principal</a>
  <a th:href="@{/web/prestamos/alta}" class="btn btn-success mb-3">Registrar Nuevo Pr√©stamo</a>

  <div th:if="${param.error}" class="alert alert-danger">
    <p th:text="${param.error}">Mensaje de error predeterminado.</p>
  </div>

  <table class="table table-striped">
    <thead>
    <tr>
      <th>ID</th>
      <th>Socio</th>
      <th>Libro</th>
      <th>Fecha Pr√©stamo</th>
      <th>Fecha L√≠mite</th>
      <th>Fecha Devoluci√≥n</th>
      <th>Acciones</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="prestamo : ${prestamos}">
      <td th:text="${prestamo.prestamo_id}">1</td>
      <td th:text="${prestamo.socio.nombre + ' ' + prestamo.socio.apellidos}">Ana G√≥mez</td>
      <td th:text="${prestamo.libro.titulo}">Cien a√±os de soledad</td>
      <td th:text="${#temporals.format(prestamo.fecha_prestamo, 'dd-MM-yyyy HH:mm')}">07/12/2025</td>
      <td th:text="${#temporals.format(prestamo.fecha_limite, 'dd-MM-yyyy HH:mm')}">09/12/2025</td>
      <td th:text="${prestamo.fecha_devolucion} ? ${#temporals.format(prestamo.fecha_devolucion, 'dd-MM-yyyy HH:mm')} : 'Activo'">Activo/Devuelto</td>
      <td>
        <a th:if="${prestamo.fecha_devolucion == null}"
           th:href="@{/web/prestamos/devolver/{id}(id=${prestamo.prestamo_id})}"
           class="btn btn-primary btn-sm me-2"
           onclick="return confirm('¬øConfirma la devoluci√≥n? Se aplicar√°n penalizaciones si hay retraso.')">
          Devolver
        </a>
        <a th:href="@{/web/prestamos/baja/{id}(id=${prestamo.prestamo_id})}"
           class="btn btn-danger btn-sm"
           onclick="return confirm('ADVERTENCIA: ¬øConfirma la eliminaci√≥n del registro? Esto no es una devoluci√≥n.')">
          Baja
        </a>
      </td>
    </tr>
    </tbody>
  </table>
</div>
</body>
</html>